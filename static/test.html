<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover">
    <title>é˜…è®° - H5æµ‹è¯•é¡µé¢</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'Helvetica Neue', Helvetica, Arial, sans-serif; }
        .app { min-height: 100vh; background: #f5f5f5; }
        .navbar { background: #059669; color: white; padding: 15px 20px; text-align: center; font-size: 18px; font-weight: 500; }
        .content { padding: 20px; }
        .test-status { background: white; border-radius: 8px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .test-status h2 { font-size: 20px; margin-bottom: 15px; }
        .status-item { margin: 10px 0; padding: 10px; background: #f0f9ff; border-radius: 4px; }
        .status-item.success { background: #f0fdf4; color: #166534; }
        .status-item.error { background: #fef2f2; color: #991b1b; }
        .tabbar { position: fixed; bottom: 0; left: 0; right: 0; background: white; display: flex; box-shadow: 0 -2px 8px rgba(0,0,0,0.1); }
        .tab-item { flex: 1; padding: 10px; text-align: center; cursor: pointer; transition: all 0.3s; }
        .tab-item:hover { background: #f5f5f5; }
        .tab-item.active { color: #059669; }
        .tab-item div { font-size: 12px; margin-top: 4px; }
        .book-list { display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 15px; margin-top: 20px; }
        .book-card { background: white; border-radius: 8px; padding: 15px; text-align: center; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .book-cover { width: 100%; aspect-ratio: 3/4; background: #e5e5e5; border-radius: 4px; margin-bottom: 10px; display: flex; align-items: center; justify-content: center; color: #999; }
        .book-title { font-size: 14px; font-weight: 500; margin-bottom: 5px; }
        .book-author { font-size: 12px; color: #666; }
        .add-btn { position: fixed; right: 20px; bottom: 80px; width: 56px; height: 56px; background: #059669; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 24px; box-shadow: 0 4px 12px rgba(5, 150, 105, 0.4); cursor: pointer; }
    </style>
</head>
<body>
    <div class="app">
        <div class="navbar">é˜…è®° - H5æµ‹è¯•é¡µé¢</div>
        
        <div class="content" style="padding-bottom: 70px;">
            <div class="test-status">
                <h2>æµ‹è¯•çŠ¶æ€</h2>
                <div class="status-item success">âœ“ H5é¡µé¢åŠ è½½æˆåŠŸ</div>
                <div class="status-item success">âœ“ æ ·å¼æ¸²æŸ“æ­£å¸¸</div>
                <div class="status-item success">âœ“ å“åº”å¼å¸ƒå±€æ­£å¸¸</div>
                <div class="status-item" id="api-status">â³ APIè¿æ¥æµ‹è¯•ä¸­...</div>
                <div class="status-item" id="storage-status">â³ æœ¬åœ°å­˜å‚¨æµ‹è¯•ä¸­...</div>
            </div>
            
            <div id="page-content">
                <!-- åŠ¨æ€å†…å®¹åŒºåŸŸ -->
            </div>
        </div>
        
        <div class="tabbar">
            <div class="tab-item active" onclick="switchTab('bookshelf')">
                <div>ğŸ“š</div>
                <div>ä¹¦æ¶</div>
            </div>
            <div class="tab-item" onclick="switchTab('notes')">
                <div>ğŸ“</div>
                <div>ç¬”è®°</div>
            </div>
            <div class="tab-item" onclick="switchTab('mindmap')">
                <div>ğŸ§ </div>
                <div>æ€ç»´å¯¼å›¾</div>
            </div>
            <div class="tab-item" onclick="switchTab('profile')">
                <div>ğŸ‘¤</div>
                <div>æˆ‘çš„</div>
            </div>
        </div>
        
        <div class="add-btn" onclick="addNew()">+</div>
    </div>
    
    <script>
        // æµ‹è¯•é¡µé¢åŠŸèƒ½
        let currentTab = 'bookshelf';
        
        // é¡µé¢å†…å®¹æ¨¡æ¿
        const pageTemplates = {
            bookshelf: `
                <h2 style="margin-bottom: 10px;">æˆ‘çš„ä¹¦æ¶</h2>
                <div class="book-list">
                    <div class="book-card">
                        <div class="book-cover">å°é¢1</div>
                        <div class="book-title">è®¤çŸ¥è§‰é†’</div>
                        <div class="book-author">å‘¨å²­</div>
                    </div>
                    <div class="book-card">
                        <div class="book-cover">å°é¢2</div>
                        <div class="book-title">è¢«è®¨åŒçš„å‹‡æ°”</div>
                        <div class="book-author">å²¸è§ä¸€éƒ</div>
                    </div>
                    <div class="book-card">
                        <div class="book-cover">å°é¢3</div>
                        <div class="book-title">åŸåˆ™</div>
                        <div class="book-author">ç‘Â·è¾¾åˆ©æ¬§</div>
                    </div>
                    <div class="book-card">
                        <div class="book-cover">+</div>
                        <div class="book-title">æ·»åŠ æ–°ä¹¦</div>
                        <div class="book-author"></div>
                    </div>
                </div>
            `,
            notes: `
                <h2>æˆ‘çš„ç¬”è®°</h2>
                <div style="margin-top: 20px;">
                    <div class="status-item">ğŸ“ ç¬”è®°1ï¼šå…³äºè®¤çŸ¥çš„æ€è€ƒ...</div>
                    <div class="status-item">ğŸ“ ç¬”è®°2ï¼šä»Šæ—¥è¯»ä¹¦æ„Ÿæ‚Ÿ...</div>
                    <div class="status-item">ğŸ“ ç¬”è®°3ï¼šé‡è¦è§‚ç‚¹æ‘˜å½•...</div>
                </div>
            `,
            mindmap: `
                <h2>æ€ç»´å¯¼å›¾</h2>
                <div style="margin-top: 20px; text-align: center;">
                    <div style="background: white; padding: 40px; border-radius: 8px;">
                        <p>ğŸ§  æ€ç»´å¯¼å›¾åŠŸèƒ½å±•ç¤ºåŒº</p>
                        <p style="color: #999; margin-top: 10px;">å¯è§†åŒ–æ‚¨çš„è¯»ä¹¦ç¬”è®°ç»“æ„</p>
                    </div>
                </div>
            `,
            profile: `
                <h2>ä¸ªäººä¸­å¿ƒ</h2>
                <div style="margin-top: 20px; text-align: center;">
                    <div style="width: 80px; height: 80px; background: #e5e5e5; border-radius: 50%; margin: 0 auto 10px; display: flex; align-items: center; justify-content: center;">ğŸ‘¤</div>
                    <p style="font-size: 18px; font-weight: 500;">æµ‹è¯•ç”¨æˆ·</p>
                    <p style="color: #666; margin-top: 5px;">å·²è¯»23æœ¬ Â· ç¬”è®°156æ¡</p>
                </div>
            `
        };
        
        // åˆ‡æ¢æ ‡ç­¾
        function switchTab(tab) {
            currentTab = tab;
            // æ›´æ–°æ ‡ç­¾çŠ¶æ€
            document.querySelectorAll('.tab-item').forEach(item => {
                item.classList.remove('active');
            });
            event.target.closest('.tab-item').classList.add('active');
            
            // æ›´æ–°é¡µé¢å†…å®¹
            document.getElementById('page-content').innerHTML = pageTemplates[tab];
            
            console.log('åˆ‡æ¢åˆ°æ ‡ç­¾:', tab);
            reportTestResult('tabSwitch', tab);
        }
        
        // æ·»åŠ æ–°å†…å®¹
        function addNew() {
            console.log('ç‚¹å‡»æ·»åŠ æŒ‰é’®ï¼Œå½“å‰æ ‡ç­¾:', currentTab);
            alert('æ·»åŠ æ–°' + (currentTab === 'bookshelf' ? 'ä¹¦ç±' : currentTab === 'notes' ? 'ç¬”è®°' : 'å†…å®¹'));
            reportTestResult('addButton', currentTab);
        }
        
        // æµ‹è¯•APIè¿æ¥
        async function testAPI() {
            try {
                const response = await fetch('http://localhost:8080/api/v1/health', {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                
                if (response.ok) {
                    document.getElementById('api-status').className = 'status-item success';
                    document.getElementById('api-status').textContent = 'âœ“ APIè¿æ¥æˆåŠŸ';
                } else {
                    throw new Error('APIå“åº”é”™è¯¯');
                }
            } catch (error) {
                document.getElementById('api-status').className = 'status-item error';
                document.getElementById('api-status').textContent = 'âœ— APIè¿æ¥å¤±è´¥: ' + error.message;
            }
        }
        
        // æµ‹è¯•æœ¬åœ°å­˜å‚¨
        function testStorage() {
            try {
                localStorage.setItem('test', 'H5æµ‹è¯•æ•°æ®');
                const data = localStorage.getItem('test');
                if (data === 'H5æµ‹è¯•æ•°æ®') {
                    document.getElementById('storage-status').className = 'status-item success';
                    document.getElementById('storage-status').textContent = 'âœ“ æœ¬åœ°å­˜å‚¨æ­£å¸¸';
                } else {
                    throw new Error('å­˜å‚¨æ•°æ®ä¸åŒ¹é…');
                }
            } catch (error) {
                document.getElementById('storage-status').className = 'status-item error';
                document.getElementById('storage-status').textContent = 'âœ— æœ¬åœ°å­˜å‚¨å¤±è´¥: ' + error.message;
            }
        }
        
        // æŠ¥å‘Šæµ‹è¯•ç»“æœ
        function reportTestResult(action, detail) {
            const testResult = {
                timestamp: new Date().toISOString(),
                action: action,
                detail: detail,
                userAgent: navigator.userAgent,
                screenSize: `${window.innerWidth}x${window.innerHeight}`
            };
            console.log('æµ‹è¯•ç»“æœ:', testResult);
            
            // å°†ç»“æœå­˜å‚¨åˆ°windowå¯¹è±¡ï¼Œä¾›è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬è¯»å–
            if (!window.testResults) {
                window.testResults = [];
            }
            window.testResults.push(testResult);
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œæµ‹è¯•
        document.addEventListener('DOMContentLoaded', function() {
            // åˆå§‹åŒ–æ˜¾ç¤ºä¹¦æ¶é¡µé¢
            document.getElementById('page-content').innerHTML = pageTemplates.bookshelf;
            
            // æ‰§è¡Œæµ‹è¯•
            testAPI();
            testStorage();
            
            // æŠ¥å‘Šé¡µé¢åŠ è½½æˆåŠŸ
            reportTestResult('pageLoad', 'success');
            
            console.log('H5æµ‹è¯•é¡µé¢åŠ è½½å®Œæˆ');
        });
    </script>
</body>
</html>