<!--
  登录页面 - WXML模板
  提供微信登录、隐私协议等功能
-->
<view class="login-page">
  <!-- 背景装饰 -->
  <view class="bg-decoration">
    <view class="circle circle-1"></view>
    <view class="circle circle-2"></view>
    <view class="circle circle-3"></view>
  </view>

  <!-- 主要内容 -->
  <view class="login-container">
    <!-- 品牌区域 -->
    <view class="brand-section">
      <image class="app-logo" src="/images/logo.png" mode="aspectFit" />
      <view class="app-name">阅记</view>
      <view class="app-slogan">让阅读更有价值</view>
    </view>

    <!-- 登录表单 -->
    <view class="login-form">
      <!-- 微信登录按钮 -->
      <view wx:if="{{ canIUseGetUserProfile }}">
        <van-button 
          type="primary"
          size="large"
          round
          loading="{{ loading }}"
          bind:click="onGetUserProfile"
          custom-class="login-button"
          icon="wechat"
        >
          微信一键登录
        </van-button>
      </view>

      <!-- 兼容旧版本的按钮 -->
      <button 
        wx:else
        class="wx-login-button"
        open-type="getUserInfo"
        bind:getuserinfo="onGetUserInfo"
        loading="{{ loading }}"
      >
        <van-icon name="wechat" size="20" color="white" />
        <text class="button-text">微信一键登录</text>
      </button>

      <!-- 游客登录 -->
      <view class="guest-login">
        <van-button 
          type="default"
          size="large"
          round
          bind:click="onSkipLogin"
          custom-class="guest-button"
        >
          游客模式体验
        </van-button>
      </view>
    </view>

    <!-- 功能特色 -->
    <view class="features-section">
      <view class="feature-title">为什么选择阅记？</view>
      <view class="features-list">
        <view class="feature-item">
          <van-icon name="scan" size="20" color="#4A90E2" />
          <text class="feature-text">智能OCR识别笔记</text>
        </view>
        <view class="feature-item">
          <van-icon name="cluster-o" size="20" color="#4A90E2" />
          <text class="feature-text">自动生成思维导图</text>
        </view>
        <view class="feature-item">
          <van-icon name="shield-o" size="20" color="#4A90E2" />
          <text class="feature-text">严格保护用户隐私</text>
        </view>
        <view class="feature-item">
          <van-icon name="cloud-o" size="20" color="#4A90E2" />
          <text class="feature-text">云端同步永不丢失</text>
        </view>
      </view>
    </view>

    <!-- 协议区域 -->
    <view class="agreement-section">
      <view class="agreement-text">
        登录即表示同意
        <text class="link-text" bind:tap="onViewUserAgreement">《用户协议》</text>
        和
        <text class="link-text" bind:tap="onViewPrivacyPolicy">《隐私政策》</text>
      </view>
    </view>

    <!-- 底部信息 -->
    <view class="footer-section">
      <view class="contact-info">
        <text>遇到问题？</text>
        <text class="contact-link" bind:tap="onContactService">联系客服</text>
      </view>
      <view class="version-info">
        阅记 v1.0.0
      </view>
    </view>
  </view>

  <!-- 隐私协议弹窗 -->
  <van-popup 
    show="{{ showPrivacyModal }}"
    position="center"
    round
    closeable
    close-on-click-overlay="{{ false }}"
    bind:close="onClosePrivacy"
    custom-style="width: 80%; max-height: 70%;"
  >
    <view class="privacy-modal">
      <view class="privacy-header">
        <view class="privacy-title">隐私保护承诺</view>
      </view>
      <scroll-view class="privacy-content" scroll-y>
        <view class="privacy-section">
          <view class="section-title">我们如何保护您的隐私</view>
          <view class="section-text">
            阅记严格遵守相关法律法规，采用业界标准的安全技术保护您的个人信息：
          </view>
        </view>
        
        <view class="privacy-section">
          <view class="section-title">数据收集</view>
          <view class="section-text">
            • 仅收集必要的微信用户基本信息（昵称、头像）\n
            • 您的阅读笔记内容仅存储在您的设备和加密云端\n
            • 不会收集或分析您的阅读内容
          </view>
        </view>
        
        <view class="privacy-section">
          <view class="section-title">数据使用</view>
          <view class="section-text">
            • 个人信息仅用于提供服务和改善用户体验\n
            • 笔记内容经过端到端加密存储\n
            • 绝不向第三方出售或泄露您的个人信息
          </view>
        </view>
        
        <view class="privacy-section">
          <view class="section-title">数据安全</view>
          <view class="section-text">
            • 采用SSL/TLS加密传输\n
            • 服务器数据采用AES-256加密存储\n
            • 定期进行安全审计和漏洞修复
          </view>
        </view>
      </scroll-view>
      
      <view class="privacy-footer">
        <van-button 
          type="primary"
          size="large"
          round
          bind:click="onAgreePrivacy"
        >
          我已了解并同意
        </van-button>
      </view>
    </view>
  </van-popup>

  <!-- Toast 提示 -->
  <van-toast id="van-toast" />
</view>