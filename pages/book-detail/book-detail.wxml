<view class="page">
  <view class="header" wx:if="{{ book }}">
    <image class="cover" src="{{ book.coverUrl || '/images/book-placeholder.png' }}" mode="aspectFill" />
    <view class="meta">
      <view class="title">{{ book.title }}</view>
      <view class="author">{{ book.author }}</view>
      <view class="stats">{{ book.noteCount || 0 }} 条笔记</view>
    </view>
  </view>

  <view class="toolbar">
    <van-button size="small" type="primary" round bind:click="onCreateNote">新建笔记</van-button>
  </view>

  <view class="section">
    <view class="section-title">笔记</view>
    <van-cell-group>
      <van-cell
        wx:for="{{ notes }}"
        wx:key="id"
        title="{{ item.content.substring(0, 24) }}"
        label="{{ formatTime(item.updatedAt) }}"
        is-link
        data-id="{{ item.id }}"
        bind:click="onOpenNote"
      />
      <van-empty wx:if="{{ !loading && notes.length === 0 }}" description="暂无笔记" />
    </van-cell-group>
  </view>

  <view class="loading" wx:if="{{ loading }}">
    <van-loading size="24px" type="spinner">加载中...</van-loading>
  </view>
</view>
