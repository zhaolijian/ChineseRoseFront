"use strict";const t=new class{isDevelopment(){return!0}formatTimestamp(t){try{const e=new Date(t),o=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0"),a=String(e.getHours()).padStart(2,"0"),n=String(e.getMinutes()).padStart(2,"0"),i=String(e.getSeconds()).padStart(2,"0");return`${o}-${r}-${s} ${a}:${n}:${i}.${String(e.getMilliseconds()).padStart(3,"0")}`}catch(e){return"Invalid Date"}}validateContext(t){if(!t)throw new Error("Context不能为空");if(["traceId","userId","timestamp","platform"].filter(e=>void 0===t[e]||null===t[e]).length>0)throw new Error("Context必须包含所有必填字段")}logToConsole(t,e,o,r){const s=`[${this.formatTimestamp(Date.now())}] [${t}] [${o.traceId}] ${e}`;switch(t){case"ERROR":console.error(s,o,r);break;case"WARN":console.warn(s,o,r);break;case"INFO":console.log(s,o,r);break;case"DEBUG":console.debug(s,o,r)}}log(t,e,o,r){if(this.validateContext(e),this.isDevelopment())this.logToConsole(t,o,e,r);else{const s={level:t,message:o,context:e,timestamp:this.formatTimestamp(Date.now()),extra:r};this.report(s)}}error(t,e,o){this.log("ERROR",t,e,o)}warn(t,e,o){this.log("WARN",t,e,o)}info(t,e,o){this.log("INFO",t,e,o)}debug(t,e,o){this.log("DEBUG",t,e,o)}report(t){this.isDevelopment()||console.log("[Logger] 生产环境日志（待上报）:",t)}};exports.logger=t;
