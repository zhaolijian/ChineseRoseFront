"use strict";const e=require("../../../../common/vendor.js");e.Schema.warning=function(){};const t={name:"u-form",mixins:[e.mpMixin,e.mixin,e.props$12],provide(){return{uForm:this}},data:()=>({formRules:{},validator:{},originalModel:null}),watch:{rules:{immediate:!0,handler(e){this.setRules(e)}},propsChange(e){var t;(null==(t=this.children)?void 0:t.length)&&this.children.map(e=>{"function"==typeof e.updateParentData&&e.updateParentData()})},model:{immediate:!0,handler(t){this.originalModel||(this.originalModel=e.deepClone(t))}}},computed:{propsChange(){return[this.errorType,this.borderBottom,this.labelPosition,this.labelWidth,this.labelAlign,this.labelStyle]}},created(){this.children=[]},methods:{setRules(t){0!==Object.keys(t).length&&(this.formRules=t,this.validator=new e.Schema(t))},resetFields(){this.resetModel()},resetModel(t){this.children.map(t=>{const r=null==t?void 0:t.prop,i=e.getProperty(this.originalModel,r);e.setProperty(this.model,r,i)})},clearValidate(e){e=[].concat(e),this.children.map(t=>{(void 0===e[0]||e.includes(t.prop))&&(t.message=null)})},validateField(t,r,i=null,o){return l=this,n=null,s=function*(){this.$nextTick(()=>{const l=[];t=[].concat(t);let n=this.children.map(r=>new Promise((n,s)=>{const a=[];if(t.includes(r.prop)){const t=e.getProperty(this.model,r.prop),s=r.prop.split("."),h=s[s.length-1];let c=[];if(c=r.itemRules&&r.itemRules.length>0?r.itemRules:this.formRules[r.prop],!c)return void n();const d=[].concat(c);d.length||n();for(let p=0;p<d.length;p++){const s=d[p],c=[].concat(null==s?void 0:s.trigger);!i||c.includes(i)?new e.Schema({[h]:s}).validate({[h]:t},(t,i)=>{var s;e.test.array(t)&&(t.forEach(e=>{e.prop=r.prop}),l.push(...t),a.push(...t)),o&&1!=(null==o?void 0:o.showErrorMsg)||(r.message=(null==(s=a[0])?void 0:s.message)?a[0].message:null),p==d.length-1&&n(l)}):n()}}else n({})}));Promise.all(n).then(e=>{"function"==typeof r&&r(l)}).catch(e=>{console.error("An error occurred:",e)})})},new Promise((e,t)=>{var r=e=>{try{o(s.next(e))}catch(r){t(r)}},i=e=>{try{o(s.throw(e))}catch(r){t(r)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(r,i);o((s=s.apply(l,n)).next())});var l,n,s},validate(t){return new Promise((r,i)=>{this.$nextTick(()=>{const o=this.children.map(e=>e.prop);this.validateField(o,t=>{t.length?("toast"===this.errorType&&e.toast(t[0].message),i(t)):r(!0)},null,t)})})}}};const r=e._export_sfc(t,[["render",function(e,t,r,i,o,l){return{}}]]);wx.createComponent(r);
