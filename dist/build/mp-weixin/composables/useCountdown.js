"use strict";const e=require("../common/vendor.js"),t=require("../constants/storage.js");exports.useCountdown=function(n=`${t.STORAGE_PREFIX}smsCodeEndTime`){const o=e.ref(0);let r=null;const s=()=>{const t=e.index.getStorageSync(n);if(!t)return void a();const r=Date.now(),s=Math.floor((t-r)/1e3);s<=0?(a(),e.index.removeStorageSync(n)):o.value=s},a=()=>{r&&(clearInterval(r),r=null),o.value=0};return e.onUnmounted(()=>{r&&clearInterval(r)}),{countdown:o,start:t=>{a();const c=Date.now()+1e3*t;e.index.setStorageSync(n,c),o.value=t,r=setInterval(s,1e3)},stop:a,restore:()=>{a();const t=e.index.getStorageSync(n);if(!t)return;const c=Date.now(),l=Math.floor((t-c)/1e3);l>0?(o.value=l,r=setInterval(s,1e3)):e.index.removeStorageSync(n)}}};
