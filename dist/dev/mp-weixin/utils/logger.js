"use strict";const t=require("../common/vendor.js");const e=new class{isDevelopment(){return!0}formatTimestamp(t){try{const e=new Date(t),r=e.getFullYear(),o=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0"),n=String(e.getHours()).padStart(2,"0"),s=String(e.getMinutes()).padStart(2,"0"),i=String(e.getSeconds()).padStart(2,"0");return`${r}-${o}-${a} ${n}:${s}:${i}.${String(e.getMilliseconds()).padStart(3,"0")}`}catch(e){return"Invalid Date"}}validateContext(t){if(!t)throw new Error("Context不能为空");if(["traceId","userId","timestamp","platform"].filter(e=>void 0===t[e]||null===t[e]).length>0)throw new Error("Context必须包含所有必填字段")}logToConsole(t,e,r,o){const a=`[${this.formatTimestamp(Date.now())}] [${t}] [${r.traceId}] ${e}`;switch(t){case"ERROR":console.error(a,r,o);break;case"WARN":console.warn(a,r,o);break;case"INFO":console.log(a,r,o);break;case"DEBUG":console.debug(a,r,o)}}log(t,e,r,o){this.validateContext(e),this.isDevelopment()?this.logToConsole(t,r,e,o):"ERROR"!==t&&"WARN"!==t||this.reportToWechat(t,r,e,o)}error(t,e,r){this.log("ERROR",t,e,r)}warn(t,e,r){this.log("WARN",t,e,r)}info(t,e,r){this.log("INFO",t,e,r)}debug(t,e,r){this.log("DEBUG",t,e,r)}reportToWechat(e,r,o,a){try{if(void 0===t.wx$1||"function"!=typeof t.wx$1.getRealtimeLogManager)return;const n=t.wx$1.getRealtimeLogManager(),s={traceId:o.traceId,userId:o.userId,platform:o.platform,timestamp:o.timestamp,extra:a};"ERROR"===e?n.error(r,s):"WARN"===e&&n.warn(r,s)}catch(n){}}report(t){}};exports.logger=e;
