"use strict";const t=require("../common/vendor.js"),e=require("../stores/modules/user.js");function n(){var n;let r="",o="unknown";try{const o=e.useUserStore();(null==(n=o.userInfo)?void 0:n.id)&&(r=function(e){try{if(!e)return"";const n=t.CryptoJS.MD5(e).toString();return n.substring(0,8)+n.substring(n.length-8)}catch(n){return console.warn("[Logger] 哈希用户ID失败:",n),""}}(o.userInfo.id))}catch(u){console.warn("[Logger] 获取用户信息失败:",u)}try{o=t.index.getSystemInfoSync().platform||"unknown"}catch(u){console.warn("[Logger] 获取平台信息失败:",u)}return{traceId:Date.now().toString()+Math.random().toString(36).substring(2,6),userId:r,timestamp:Date.now(),platform:o}}let r=null,o=null;exports.clearRequestContext=function(){r=null,o&&(clearTimeout(o),o=null)},exports.createContext=n,exports.createRequestContext=function(){return r||(r=n(),o&&clearTimeout(o),o=setTimeout(()=>{r=null,o=null},5e3),r)};
