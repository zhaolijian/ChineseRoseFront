"use strict";const e=require("../../../../common/vendor.js");e.Schema.warning=function(){};const t={name:"u-form",mixins:[e.mpMixin,e.mixin,e.props$12],provide(){return{uForm:this}},data:()=>({formRules:{},validator:{},originalModel:null}),watch:{rules:{immediate:!0,handler(e){this.setRules(e)}},propsChange(e){var t;(null==(t=this.children)?void 0:t.length)&&this.children.map(e=>{"function"==typeof e.updateParentData&&e.updateParentData()})},model:{immediate:!0,handler(t){this.originalModel||(this.originalModel=e.deepClone(t))}}},computed:{propsChange(){return[this.errorType,this.borderBottom,this.labelPosition,this.labelWidth,this.labelAlign,this.labelStyle]}},created(){this.children=[]},methods:{setRules(t){0!==Object.keys(t).length&&(0!==Object.keys(this.model).length?(this.formRules=t,this.validator=new e.Schema(t)):e.error("设置rules，model必须设置！如果已经设置，请刷新页面。"))},resetFields(){this.resetModel()},resetModel(t){this.children.map(t=>{const r=null==t?void 0:t.prop,o=e.getProperty(this.originalModel,r);e.setProperty(this.model,r,o)})},clearValidate(e){e=[].concat(e),this.children.map(t=>{(void 0===e[0]||e.includes(t.prop))&&(t.message=null)})},validateField(t,r,o=null,s){return i=this,l=null,n=function*(){this.$nextTick(()=>{const i=[];t=[].concat(t);let l=this.children.map(r=>new Promise((l,n)=>{const a=[];if(t.includes(r.prop)){const t=e.getProperty(this.model,r.prop),n=r.prop.split("."),h=n[n.length-1];let c=[];if(c=r.itemRules&&r.itemRules.length>0?r.itemRules:this.formRules[r.prop],!c)return void l();const d=[].concat(c);d.length||l();for(let u=0;u<d.length;u++){const n=d[u],c=[].concat(null==n?void 0:n.trigger);!o||c.includes(o)?new e.Schema({[h]:n}).validate({[h]:t},(t,o)=>{var n;e.test.array(t)&&(t.forEach(e=>{e.prop=r.prop}),i.push(...t),a.push(...t)),s&&1!=(null==s?void 0:s.showErrorMsg)||(r.message=(null==(n=a[0])?void 0:n.message)?a[0].message:null),u==d.length-1&&l(i)}):l()}}else l({})}));Promise.all(l).then(e=>{"function"==typeof r&&r(i)}).catch(e=>{console.error("An error occurred:",e)})})},new Promise((e,t)=>{var r=e=>{try{s(n.next(e))}catch(r){t(r)}},o=e=>{try{s(n.throw(e))}catch(r){t(r)}},s=t=>t.done?e(t.value):Promise.resolve(t.value).then(r,o);s((n=n.apply(i,l)).next())});var i,l,n},validate(t){if(0!==Object.keys(this.formRules).length)return new Promise((r,o)=>{this.$nextTick(()=>{const s=this.children.map(e=>e.prop);this.validateField(s,t=>{t.length?("toast"===this.errorType&&e.toast(t[0].message),o(t)):r(!0)},null,t)})});e.error("未设置rules，请看文档说明！如果已经设置，请刷新页面。")}}};const r=e._export_sfc(t,[["render",function(e,t,r,o,s,i){return{}}],["__file","/Users/zhaolijian/Projects/chinese-rose-front/node_modules/uview-plus/components/u-form/u-form.vue"]]);wx.createComponent(r);
