"use strict";var e=(e,o,r)=>new Promise((t,s)=>{var n=e=>{try{a(r.next(e))}catch(o){s(o)}},i=e=>{try{a(r.throw(e))}catch(o){s(o)}},a=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,i);a((r=r.apply(e,o)).next())});const o=require("../../common/vendor.js"),r=require("../../stores/modules/user.js"),t=require("../../stores/modules/book.js"),s=require("../../api/modules/auth.js");if(require("../../utils/storage.js"),require("../../constants/storage.js"),require("../../utils/logger.js"),require("../../utils/logger-helpers.js"),require("../../utils/request.js"),require("../../constants/request.js"),require("../../utils/error-handler.js"),require("../../types/errorCodes.js"),require("../../utils/base64.js"),!Array){(o.resolveComponent("u-avatar")+o.resolveComponent("u-icon"))()}const n=o.defineComponent({__name:"index",setup(n){const i=r.useUserStore();t.useBookStore();const a=o.ref(12),u=o.ref(156),l=o.ref(8);o.computed(()=>i.userInfo);const c=o.computed(()=>i.userNickname||"阅记用户"),d=o.computed(()=>i.userAvatar||"/static/images/default-avatar.png");o.onMounted(()=>e(this,null,function*(){yield m()})),o.onShow(()=>e(this,null,function*(){yield m()}));const m=()=>e(this,null,function*(){try{const e=yield s.getUserStats();a.value=e.bookCount,u.value=e.noteCount,l.value=e.mindmapCount}catch(e){console.error("加载用户统计失败:",e),a.value=0,u.value=0,l.value=0}}),h=()=>{o.index.showToast({title:"功能开发中",icon:"none"})},p=()=>{o.index.showToast({title:"功能开发中",icon:"none"})},v=()=>{o.index.showToast({title:"功能开发中",icon:"none"})},g=()=>{o.index.showToast({title:"功能开发中",icon:"none"})},f=()=>{o.index.showModal({title:"确认退出",content:"确定要退出登录吗？",success:r=>e(this,null,function*(){if(r.confirm)try{yield i.logout(),o.index.showToast({title:"已退出登录",icon:"success"}),setTimeout(()=>{o.index.reLaunch({url:"/pages/login/login"})},1500)}catch(e){console.error("退出登录失败:",e),o.index.showToast({title:"退出失败",icon:"error"})}})})};return(e,r)=>({a:o.p({src:o.unref(d),size:"64",mode:"aspectFill"}),b:o.t(o.unref(c)),c:o.p({name:"chart-line",size:"20",color:"#00a82d"}),d:o.t(a.value),e:o.t(u.value),f:o.t(l.value),g:o.p({name:"bell",size:"20",color:"#666"}),h:o.p({name:"arrow-right",size:"16",color:"#999"}),i:o.o(h),j:o.p({name:"share-square",size:"20",color:"#666"}),k:o.p({name:"arrow-right",size:"16",color:"#999"}),l:o.o(p),m:o.p({name:"question-circle",size:"20",color:"#666"}),n:o.p({name:"arrow-right",size:"16",color:"#999"}),o:o.o(v),p:o.p({name:"info-circle",size:"20",color:"#666"}),q:o.p({name:"arrow-right",size:"16",color:"#999"}),r:o.o(g),s:o.o(f)})}}),i=o._export_sfc(n,[["__scopeId","data-v-1aeae86e"]]);wx.createPage(i);
